<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Cardiovascular Risk Decision Aid</title>
  <link rel="stylesheet" href="styles.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <header>
    <h1>Cardiovascular Risk Calculator &amp; Decision Aid</h1>
    <p>
      Estimate baseline cardiovascular risk and visualize potential benefit from blood pressure and statin therapies using FINRISK or PREVENT Total CVD risk models.
    </p>
  </header>

  <main>
    <section class="calculator">
      <form id="risk-form">
        <div class="form-grid">
          <label for="model">Risk estimation method</label>
          <select id="model" name="model">
            <option value="finrisk">FINRISK (Finland)</option>
            <option value="riskcalculator">PREVENT Total CVD (United States)</option>
          </select>

          <label for="age">Age (years)</label>
          <input type="number" id="age" name="age" min="20" max="90" required />

          <label for="sex">Sex</label>
          <select id="sex" name="sex">
            <option value="male">Male</option>
            <option value="female">Female</option>
          </select>

          <label for="systolic">Systolic blood pressure (mmHg)</label>
          <input type="number" id="systolic" name="systolic" min="90" max="250" required />

          <label for="totalChol">Total cholesterol (mmol/L or mg/dL)</label>
          <input type="number" id="totalChol" name="totalChol" min="2" max="320" step="0.1" required />

          <label for="hdl">HDL cholesterol (mmol/L or mg/dL)</label>
          <input type="number" id="hdl" name="hdl" min="0.5" max="100" step="0.1" required />

          <label for="smoker">Current smoker</label>
          <select id="smoker" name="smoker">
            <option value="no">No</option>
            <option value="yes">Yes</option>
          </select>

         <label for="diabetes">Diabetes</label>
          <select id="diabetes" name="diabetes">
            <option value="no">No</option>
            <option value="yes">Yes</option>
          </select>

          <label for="parentInfarction" class="finrisk-only">Parental history of myocardial infarction</label>
          <select id="parentInfarction" name="parentInfarction" class="finrisk-only">
            <option value="no">No</option>
            <option value="yes">Yes</option>
          </select>

          <label for="parentStroke" class="finrisk-only">Parental history of stroke</label>
          <select id="parentStroke" name="parentStroke" class="finrisk-only">
            <option value="no">No</option>
            <option value="yes">Yes</option>
          </select>

          <label for="bpMedicated" class="riskcalculator-only">On blood pressure medication</label>
          <select id="bpMedicated" name="bpMedicated" class="riskcalculator-only">
            <option value="no">No</option>
            <option value="yes">Yes</option>
          </select>

          <label for="statin" class="riskcalculator-only">On statin therapy</label>
          <select id="statin" name="statin" class="riskcalculator-only">
            <option value="no">No</option>
            <option value="yes">Yes</option>
          </select>

          <label for="egfr" class="riskcalculator-only">Estimated GFR (mL/min/1.73m²)</label>
          <input
            type="number"
            id="egfr"
            name="egfr"
            class="riskcalculator-only"
            min="15"
            max="150"
            step="1"
            value="90"
          />
        </div>

        <div class="actions">
          <button type="submit">Calculate risk</button>
          <p class="disclaimer">This tool is for educational purposes and does not replace clinical judgement. Please review inputs and outputs with a healthcare professional.</p>
        </div>
      </form>
    </section>

    <section class="results" aria-live="polite">
      <div class="result-summary">
        <h2>Estimated 10-year cardiovascular risk</h2>
        <p id="baseline-risk">Baseline risk: <strong>--</strong></p>
      </div>

      <div class="chart-controls">
        <h3>Select treatments to display</h3>
        <div
          id="treatment-checkboxes"
          class="checkbox-group"
          role="group"
          aria-label="Treatment options to include in chart"
        ></div>
      </div>

      <details id="treatment-details" class="treatment-summary">
        <summary id="treatment-summary">
          <span id="treatment-summary-label">Numerical treatment estimates</span>
          <span id="treatment-summary-baseline" class="summary-baseline"></span>
        </summary>
        <div class="treatment-summary-content">
          <p id="treatment-summary-note" class="treatment-summary-note">
            Calculate risk to view estimated benefits for each treatment strategy.
          </p>
          <ul id="treatment-list" class="treatment-list"></ul>
        </div>
      </details>

      <div class="chart-container">
        <canvas id="risk-chart" aria-label="Risk reduction chart" role="img"></canvas>
      </div>
    </section>
  </main>

  <footer>
    <p>&copy; <span id="year"></span> Cardiovascular Decision Support.</p>
    <section class="reference-list" aria-labelledby="reference-heading">
      <h2 id="reference-heading">Risk algorithm references</h2>
      <ol>
        <li>
          Vartiainen V, Laatikainen T, Jousilahti P, Peltonen M, Niiranen T, Salomaa V.
          Sepelvaltimotaudin ja aivohalvauksen riskin arviointi FINRISKI 2.0 -laskurilla.
          <em>Suomen Lääkärilehti</em>. 2020;75:2778-2782.
        </li>
        <li>
          Khan SS, Matsushita K, Sang Y, Ballew SH, Grams ME, Surapaneni A, Blaha MJ, Carson AP,
          Chang AR, Ciemins E, Go AS, Gutierrez OM, Hwang SJ, Jassal SK, Kovesdy CP, Lloyd-Jones DM,
          Shlipak MG, Palaniappan LP, Sperling L, Virani SS, Tuttle K, Neeland IJ, Chow SL,
          Rangaswami J, Pencina MJ, Ndumele CE, Coresh J; Chronic Kidney Disease Prognosis Consortium
          and the American Heart Association Cardiovascular-Kidney-Metabolic Science Advisory Group.
          Development and Validation of the American Heart Association's PREVENT Equations.
          <em>Circulation</em>. 2024 Feb 6;149(6):430-449. doi: 10.1161/CIRCULATIONAHA.123.067626.
          Epub 2023 Nov 10. Erratum in: <em>Circulation</em>. 2024 Mar 12;149(11):e956.
          doi: 10.1161/CIR.0000000000001230. PMID: 37947085; PMCID: PMC10910659.
        </li>
      </ol>
    </section>
  </footer>

  <script src="risk-core.js"></script>
  <script src="script.js"></script>
</body>
</html>
